<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>🦾 Doosan Teststand — Advanced Simulation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="Assets/css/styles.css">
</head>
<body>
<header>🦾 Doosan Teststand — Advanced Simulation</header>

<main>
  <!-- LEFT: Scene -->
  <div class="card scene-card">
    <h2>Robot & Teststand (Simulation)</h2>
    <div class="scene-wrap">
      <!-- Scalable SVG workspace -->
      <svg id="svg" viewBox="0 0 800 450" width="100%" height="100%">
        <!-- Floor -->
        <rect x="0" y="350" width="800" height="100" fill="#e8edf5"/>
        <!-- Teststand -->
        <rect x="520" y="280" width="200" height="70" rx="8" fill="#ccd9ea" stroke="#9cb5d6"/>
        <rect x="560" y="260" width="120" height="20" rx="4" fill="#b7c8e1"/>
        <!-- Panel on stand (target) -->
        <!-- Panel at P1 (stack) - visible at start -->
        <rect id="panelStack" x="752" y="274" width="36" height="12" rx="2" fill="#2ecc71" opacity="1"/>
        <!-- Panel at P3 (on stand) - hidden at start -->
        <rect id="panelStand" x="590" y="274" width="60" height="12" rx="2" fill="#2ecc71" opacity="0"/>
        <!-- Pick area (stack) -->
        <rect x="730" y="300" width="80" height="20" rx="4" fill="#dfe6ee" stroke="#c9d3e3"/>
        <rect x="740" y="280" width="60" height="16" rx="3" fill="#bfcde2"/>
        <!-- Drop-off area P4 -->
        <rect x="430" y="300" width="80" height="20" rx="4" fill="#dfe6ee" stroke="#c9d3e3"/>
        <rect x="440" y="290" width="60" height="16" rx="3" fill="#bfcde2"/>
        <!-- Panel at P4 (hidden at start) -->
        <rect id="panelP4" x="452" y="292" width="36" height="12" rx="2" fill="#2ecc71" opacity="0"/>
        <!-- Markers -->
        <circle cx="770" cy="280" r="5" fill="#8e44ad"/>   <!-- P1 -->
        <circle cx="620" cy="240" r="5" fill="#16a085"/>   <!-- P2 -->
        <circle cx="620" cy="280" r="5" fill="#c0392b"/>   <!-- P3 -->
        <circle cx="470" cy="280" r="5" fill="#2980b9"/>   <!-- P4 -->

        <!-- Robot base -->
        <g id="robot" transform="translate(620,340)">
          <rect x="-25" y="5" width="50" height="20" rx="6" fill="#8aa0b8"/>
          <!-- Link1 -->
          <g id="link1" transform="rotate(-60)">
            <rect x="0" y="-10" width="140" height="20" rx="10" fill="#2c3e50"/>
            <!-- Joint1 -->
            <circle cx="0" cy="0" r="10" fill="#34495e"/>
            <!-- Link2 -->
            <g id="link2" transform="translate(140,0) rotate(40)">
              <rect x="0" y="-9" width="120" height="18" rx="9" fill="#2c3e50"/>
              <!-- Joint2 -->
              <circle cx="0" cy="0" r="9" fill="#34495e"/>
              <!-- End effector -->
              <g id="tool" transform="translate(120,0)">
                <rect x="-10" y="-16" width="20" height="32" rx="4" fill="#7f8c8d"/>
                <!-- Gripper fingers -->
                <rect id="fingerL" x="-16" y="-3" width="8" height="6" rx="2" fill="#95a5a6"/>
                <rect id="fingerR" x="8" y="-3" width="8" height="6" rx="2" fill="#95a5a6"/>
                <!-- Carried panel -->
                <rect id="panelCarry" x="-18" y="-6" width="36" height="12" rx="2" fill="#2ecc71" opacity="0"/>
              </g>
            </g>
          </g>
        </g>
      </svg>
    </div>
    <div class="legend">
      <span class="badge"><span class="dot dot-pick"></span> P1 Pick</span>
      <span class="badge"><span class="dot dot-over"></span> P2 Over Stand</span>
      <span class="badge"><span class="dot dot-place"></span> P3 Place</span>
      <span class="badge">Link lengths: L1=140, L2=120 (sim)</span>
    </div>
  </div>

  <!-- RIGHT: Controls + LEDs -->
  <div class="card">
    <h2>Controls</h2>
    <div class="controls">
      <button id="btnRobot"  class="btn-robot"  type="button">RobotAt = 0</button>
      <button id="btnSensor" class="btn-sensor" type="button">Sensor = 0</button>
      <button id="btnAuto"   class="btn-auto"   type="button">Auto Cycle</button>
      <button id="btnStop"   class="btn-stop"   type="button" disabled>Stop</button>
    </div>
    <p class="hint">• في وضع <b>Auto</b> الروبوت يتحرّك P1→P2→P3 ويعمل Gripper تلقائيًا.<br/>• الأزرار RobotAt/Sensor للتجربة اليدوية (Ready يطلق السيكونس تلقائيًا).</p>

    <h2 style="margin-top:16px">Status LEDs</h2>
    <div class="row"><div id="led_robot" class="led"></div><div class="label">Robot At_Target</div></div>
    <div class="row"><div id="led_sensor" class="led"></div><div class="label">Panel Sensor</div></div>
    <div class="row"><div id="led_ready" class="led"></div><div class="label">Ready (Both=1)</div></div>

    <div class="row"><div id="led_flash" class="led"></div><div class="label">Flashing</div></div>
    <div class="progress">
      <div id="bar_flash" class="bar">
        <span id="txt_flash"></span>
      </div>
    </div>

    <div class="row"><div id="led_test" class="led"></div><div class="label">Testing</div></div>
    <div class="progress">
      <div id="bar_test" class="bar">
        <span id="txt_test"></span>
      </div>
    </div>

    <div class="row"><div id="led_ack" class="led"></div><div class="label">ACK to Robot</div></div>
  </div>

  <!-- Log -->
  <div class="card" style="grid-column:1 / -1">
    <h2>Event Log</h2>
    <div id="log"></div>
  </div>
</main>

<script src="Assets/js/app.js" defer></script>
</body>
</html>
